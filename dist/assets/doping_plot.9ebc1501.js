import"./modulepreload-polyfill.b7f2da20.js";import*as t from"https://cdn.skypack.dev/d3@7";async function T(){try{const i=await t.json("https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/cyclist-data.json");i.forEach(e=>{const o=e.Time.split(":");e.Time=new Date(1970,0,1,0,o[0],o[1]),e.Year=new Date(e.Year,0)});const{clientWidth:S,clientHeight:$}=document.querySelector(".canvas"),c=75,w=S-2*c,n=$-2*c,d=t.timeFormat("%M:%S"),g=t.scaleTime().domain(t.extent(i,e=>e.Year)).range([c,c+w]),p=t.scaleTime().domain(t.extent(i,e=>e.Time)).range([c,c+n]),L=t.axisBottom(g),q=t.axisLeft(p).tickFormat(d),l=t.select(".canvas");["circle","g",".legend",".score-axis-title"].forEach(e=>t.selectAll(e).remove()),l.append("g").attr("transform",`translate(0, ${c+n})`).call(L),l.append("g").attr("transform",`translate(${c}, 0)`).call(q),t.select("body").append("text").attr("class","score-axis-title").text("Best time (min:sec)");const m=l.selectAll("circle").data(i).enter().append("circle").attr("cx",({Year:e})=>g(e)).attr("cy",({Time:e})=>p(e)).attr("r",5).attr("class",({Doping:e})=>`circle ${e?"red":"green"}`).style("fill",({Doping:e})=>e?"red":"green"),A=[{class:"doping",text:"Cyclists with doping allegations",fill:"red"},{class:"no-doping",text:"Cyclists without allegations",fill:"green"}],u=t.select("body").append("div").attr("class","legend").selectAll("div").data(A).enter().append("div").attr("class",e=>`category ${e.class}`).on("click",e=>{const o=document.querySelector(".doping"),s=document.querySelector(".no-doping");e.path.includes(o)?(o.classList.toggle("inactive"),document.querySelectorAll(".red").forEach(r=>r.classList.toggle("hide"))):(s.classList.toggle("inactive"),document.querySelectorAll(".green").forEach(r=>r.classList.toggle("hide")))});u.append("svg").attr("class","svg").append("circle").attr("cx",document.querySelector(".svg").clientWidth/2).attr("cy",document.querySelector(".svg").clientHeight/2).attr("r",document.querySelector(".svg").clientWidth/2).attr("fill",e=>e.fill),u.append("div").attr("class","text").text(e=>e.text);const a=document.querySelector(".tooltip");let y,h,f;m.on("mouseover",e=>{clearTimeout(f),a.classList.remove("hide");const{left:o,top:s}=e.target.getBoundingClientRect(),{Doping:r,Name:C,Nationality:H,Place:b,Year:v,Time:x}=e.target.__data__;let D=r?`<br><br>${r}`:"";a.innerHTML=`${C}, ${H}, #${b}<br>${v.getFullYear()}, ${d(x)}`+D,y=a.clientWidth,h=a.clientHeight,a.style.top=`${x.getMinutes()<38?s+10:s-h}px`,a.style.left=`${v.getFullYear()<2005?o:o-y}px`;const W=[{opacity:0},{opacity:1}],Y={duration:300,fill:"forwards"};a.animate(W,Y)}),m.on("mouseout",()=>{const e=[{opacity:1},{opacity:0}],o={duration:300,fill:"forwards"};a.animate(e,o),f=setTimeout(()=>a.classList.add("hide"),300)})}catch(i){console.error(i)}}T();window.onresize=T;
